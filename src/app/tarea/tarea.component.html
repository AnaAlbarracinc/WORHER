<div class="container tarea">
  <ng-container *ngIf="editando; then thenBlock; else elseBlock"></ng-container>
  <ng-template #thenBlock>
    <div class="txt_field form-control mt-4">
      <input type="text" required aria-label="Nombre de tarea" name="nombreEditar" #nombreEditar
          id="nombreEditar" value="{{tarea.nombre}}">
      <span class="span"></span>
      <label for="nombreEditar" class="control-label required">Nombre de tarea</label>
  </div>
  <label for="dificultadEditar">Dificultad</label>
  <select name="dificultadEditar" id="dificultadEditar" class="form-select" #dificultadEditar value="{{tarea.dificultad}}">
      <option value="1">Fácil</option>
      <option value="2">Normal</option>
      <option value="3">Difícil</option>
  </select>
  <label for="prioridadEditar">Prioridad</label>
  <select name="prioridadEditar" id="prioridadEditar" class="form-select" #prioridadEditar value="{{tarea.prioridad}}">
      <option value="1">Muy baja</option>
      <option value="2">Baja</option>
      <option value="3">Normal</option>
      <option value="4">Alta</option>
      <option value="5">Muy alta</option>
  </select>
  <div class="txt_field form-control mt-4">
      <textarea required aria-label="descripción de tarea" name="descripcionEditar" #descripcionEditar
          id="descripcionEditar" value="{{tarea.descripcion}}"></textarea>
      <span class="span"></span>
      <label for="descripcionEditar" class="control-label required">Descripción de tarea</label>
  </div>
  <button type="button" class="btn boton mt-2 mb-1" 
                    (click)="editar(nombreEditar.value, prioridadEditar.value, dificultadEditar.value, descripcionEditar.value)"
                    #botonEditar>Guardar cambios</button>
  <button type="button" class="btn btn-danger boton mt-1 mb-2"
                    (click)="cancelarEdicion(nombreEditar, prioridadEditar, dificultadEditar, descripcionEditar)"
                    #botonEditar>Cancelar</button>
  </ng-template>

  <ng-template #elseBlock> 
    <div id="dificultad">
      <img src="assets/images/facil.png" width="30" height="30" *ngIf="tarea.dificultad==1" />
      <img src="assets/images/normal.png" width="30" height="30" *ngIf="tarea.dificultad==2" />
      <img src="assets/images/muy_dificil.png" width="30" height="30" *ngIf="tarea.dificultad==3" />
    </div>
    
  
    <svg id="prioridad"
      [ngClass]="{ muyBaja:tarea.prioridad==1, baja: tarea.prioridad == 2, media: tarea.prioridad == 3, alta: tarea.prioridad == 4, muyAlta: tarea.prioridad == 5}"
      xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-patch-exclamation-fill"
      viewBox="0 0 16 16">
      <path
        d="M10.067.87a2.89 2.89 0 0 0-4.134 0l-.622.638-.89-.011a2.89 2.89 0 0 0-2.924 2.924l.01.89-.636.622a2.89 2.89 0 0 0 0 4.134l.637.622-.011.89a2.89 2.89 0 0 0 2.924 2.924l.89-.01.622.636a2.89 2.89 0 0 0 4.134 0l.622-.637.89.011a2.89 2.89 0 0 0 2.924-2.924l-.01-.89.636-.622a2.89 2.89 0 0 0 0-4.134l-.637-.622.011-.89a2.89 2.89 0 0 0-2.924-2.924l-.89.01-.622-.636zM8 4c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 4.995A.905.905 0 0 1 8 4zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z" />
    </svg>
    <details>
      <summary><h4 id="nombre">{{tarea.nombre}}</h4></summary>
    
    
    
      <div class="mt-3">
        <div class="datos">
          <p>Dificultad: {{getDificultad()}}</p>
          <p>Prioridad: {{getPrioridad()}}</p>
        </div>
        <div class="usuarios">
          <app-usuario [usuario]="u" *ngFor="let u of tarea.usuarios" class="usuario"></app-usuario>
        </div>
        <div class="descripcion">
          <p>{{tarea.descripcion}}</p>
        </div>
        
        <div class="botones">
          <button class="btn boton" (click)="cambiarEditando()">Editar tarea</button>
          <button class="btn boton eliminar" (click)="borrarTarea()">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-trash"
              viewBox="0 0 16 16">
              <path
                d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z" />
              <path fill-rule="evenodd"
                d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z" />
            </svg>
            Eliminar tarea</button>
        </div>
      </div>

    </details>   
  </ng-template>

</div>


